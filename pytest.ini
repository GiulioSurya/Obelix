[pytest]
# Configurazione pytest per SophIA_IC

# Path di ricerca per i test
testpaths = tests

# Pattern per identificare i file di test
python_files = test_*.py

# Pattern per identificare le classi di test
python_classes = Test*

# Pattern per identificare le funzioni di test
python_functions = test_*

# Markers personalizzati
markers =
    unit: Unit tests che non richiedono dipendenze esterne
    integration: Integration tests che possono richiedere database o servizi esterni
    slow: Test che richiedono tempo per l'esecuzione
    async_test: Test che usano async/await
    requires_db: Test che richiedono connessione al database Oracle
    requires_llm: Test che richiedono chiamate a LLM provider

# Opzioni di output
addopts =
    # Verbose output
    -v
    # Mostra summary di tutti i tipi di test
    -ra
    # Mostra assert dettagliati
    --tb=short
    # Cattura output
    --capture=no
    # Coverage (opzionale, decommentare se installato pytest-cov)
    # --cov=src
    # --cov-report=html
    # --cov-report=term-missing
    # Mostra durata dei test più lenti
    --durations=10
    # Strict markers (fallisce se usi marker non dichiarati)
    --strict-markers
    # Warning come errori (opzionale)
    # -W error

# Configurazione asyncio per pytest-asyncio
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Ignora warnings specifici
filterwarnings =
    ignore::DeprecationWarning:pydantic
    ignore::PendingDeprecationWarning

# Console output encoding
console_output_style = progress

# Minimi per considerare i test passati
minversion = 8.0

# Path da cui pytest può importare moduli
pythonpath = src